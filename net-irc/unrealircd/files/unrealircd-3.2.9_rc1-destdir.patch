Author: Nathan Phillip Brink <ohnobinki@ohnopublishing.net>
Date: 2010/12/15

Support DESTDIR for installing files so that paths which are hardcoded
into the binaries are distinguished from the staging-area-time paths.


Index: Makefile.in
===================================================================
RCS file: /cvs/unreal/Attic/Makefile.in,v
retrieving revision 1.1.2.23.2.12
diff -u -B -r1.1.2.23.2.12 Makefile.in
--- Makefile.in	15 Dec 2010 01:31:16 -0000	1.1.2.23.2.12
+++ Makefile.in	16 Dec 2010 00:29:23 -0000
@@ -205,29 +205,27 @@
 	done
 
 install: all
-	$(INSTALL) -m 0700 -d $(IRCDDIR)
-	$(INSTALL) -m 0700 src/ircd $(BINDIR)
-	$(INSTALL) -m 0700 -d $(IRCDDIR)/networks
-	$(INSTALL) -m 0600 networks/*.network $(IRCDDIR)/networks
-	$(INSTALL) -m 0700 networks/makenet $(IRCDDIR)/networks
-	$(INSTALL) -m 0600 networks/networks.ndx $(IRCDDIR)/networks
-	$(INSTALL) -m 0700 -d $(IRCDDIR)/doc
-	$(INSTALL) -m 0600 doc/Authors doc/example.conf doc/coding-guidelines doc/tao.of.irc doc/unreal32docs.html $(IRCDDIR)/doc
-	$(INSTALL) -m 0700 -d $(IRCDDIR)/aliases
-	$(INSTALL) -m 0600 aliases/*.conf $(IRCDDIR)/aliases
-	$(TOUCH) $(IRCDDIR)/unrealircd.conf
-	chmod 0600 $(IRCDDIR)/unrealircd.conf
-	$(INSTALL) -m 0600 spamfilter.conf dccallow.conf $(IRCDDIR)
-	$(INSTALL) -m 0600 badwords.*.conf help.conf LICENSE Donation $(IRCDDIR)
-	$(INSTALL) -m 0700 unreal $(IRCDDIR)
-	$(INSTALL) -m 0700 -d $(IRCDDIR)/modules
-	$(INSTALL) -m 0700 src/modules/*.so $(IRCDDIR)/modules
-	$(INSTALL) -m 0700 -d $(IRCDDIR)/ircdcron
-	$(INSTALL) -m 0600 ircdcron/ircd.cron $(IRCDDIR)/ircdcron
-	$(INSTALL) -m 0700 ircdcron/ircdchk $(IRCDDIR)/ircdcron
-	-@if [ ! -f "$(IRCDDIR)/curl-ca-bundle.crt" ] ; then \
-		$(INSTALL) -m 0700 curl-ca-bundle.crt $(IRCDDIR) ; \
-	fi
+	$(INSTALL) -m 0700 -d $(DESTDIR)$(IRCDDIR)
+	$(INSTALL) -m 0700 src/ircd $(DESTDIR)$(BINDIR)
+	$(INSTALL) -m 0700 -d $(DESTDIR)$(IRCDDIR)/networks
+	$(INSTALL) -m 0600 networks/*.network $(DESTDIR)$(IRCDDIR)/networks
+	$(INSTALL) -m 0700 networks/makenet $(DESTDIR)$(IRCDDIR)/networks
+	$(INSTALL) -m 0600 networks/networks.ndx $(DESTDIR)$(IRCDDIR)/networks
+	$(INSTALL) -m 0700 -d $(DESTDIR)$(IRCDDIR)/doc
+	$(INSTALL) -m 0600 doc/Authors doc/example.conf doc/coding-guidelines doc/tao.of.irc doc/unreal32docs.html $(DESTDIR)$(IRCDDIR)/doc
+	$(INSTALL) -m 0700 -d $(DESTDIR)$(IRCDDIR)/aliases
+	$(INSTALL) -m 0600 aliases/*.conf $(DESTDIR)$(IRCDDIR)/aliases
+	$(TOUCH) $(DESTDIR)$(IRCDDIR)/unrealircd.conf
+	chmod 0600 $(DESTDIR)$(IRCDDIR)/unrealircd.conf
+	$(INSTALL) -m 0600 spamfilter.conf dccallow.conf $(DESTDIR)$(IRCDDIR)
+	$(INSTALL) -m 0600 badwords.*.conf help.conf LICENSE Donation $(DESTDIR)$(IRCDDIR)
+	$(INSTALL) -m 0700 unreal $(DESTDIR)$(IRCDDIR)
+	$(INSTALL) -m 0700 -d $(DESTDIR)$(IRCDDIR)/modules
+	$(INSTALL) -m 0700 src/modules/*.so $(DESTDIR)$(IRCDDIR)/modules
+	$(INSTALL) -m 0700 -d $(DESTDIR)$(IRCDDIR)/ircdcron
+	$(INSTALL) -m 0600 ircdcron/ircd.cron $(DESTDIR)$(IRCDDIR)/ircdcron
+	$(INSTALL) -m 0700 ircdcron/ircdchk $(DESTDIR)$(IRCDDIR)/ircdcron
+	$(INSTALL) -m 0700 curl-ca-bundle.crt $(DESTDIR)$(IRCDDIR)
 
 pem:	src/ssl.cnf
 	@echo "Generating certificate request .. "
